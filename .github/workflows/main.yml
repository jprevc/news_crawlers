name: Tests

on:
  - push
  - pull_request

jobs:
  tox:
    uses: jprevc/workflows/.github/workflows/tox.yml@v1.0.0
  publish-pypi:
    if: github.event_name == 'push' && startsWith(github.ref, 'refs/tags')
    needs: tox
    uses: jprevc/workflows/.github/workflows/publish-pypi.yml@v1.0.0
    secrets: inherit
  publish-dockerhub:
    if: github.event_name == 'push' && startsWith(github.ref, 'refs/tags')
    needs: [tox, publish-pypi]
    uses: jprevc/workflows/.github/workflows/publish-dockerhub.yml@1f013ef1ac90f71c3cef55b067262fdf260e5129
    secrets: inherit
